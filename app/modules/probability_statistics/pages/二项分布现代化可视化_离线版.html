<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二项分布交互式可视化 - 离线版</title>
    
    <!-- MathJax配置 -->
    <script type="text/javascript">
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/javascript" id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <!-- 离线版本：请下载plotly.min.js到本地 -->
    <!-- 下载地址：https://cdn.plot.ly/plotly-2.26.0.min.js -->
    <script>
        // 内嵌简化版Plotly.js核心功能
        window.Plotly = {
            version: '2.26.0-embedded',
            newPlot: function(div, data, layout, config) {
                return new Promise((resolve, reject) => {
                    try {
                        const container = typeof div === 'string' ? document.getElementById(div) : div;
                        if (!container) {
                            reject(new Error('Container not found'));
                            return;
                        }
                        
                        // 清空容器
                        container.innerHTML = '';
                        
                        // 创建SVG画布
                        const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                        svg.style.width = '100%';
                        svg.style.height = '100%';
                        container.appendChild(svg);
                        
                        // 简化的绘图逻辑
                        this._drawChart(svg, data, layout, config);
                        resolve();
                    } catch (error) {
                        reject(error);
                    }
                });
            },
            
            _drawChart: function(svg, data, layout, config) {
                const width = svg.clientWidth || 800;
                const height = svg.clientHeight || 400;
                const margin = layout.margin || { t: 50, r: 50, b: 50, l: 50 };
                
                svg.setAttribute('width', width);
                svg.setAttribute('height', height);
                svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
                
                // 绘制背景
                const bg = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                bg.setAttribute('width', width);
                bg.setAttribute('height', height);
                bg.setAttribute('fill', layout.paper_bgcolor || 'white');
                svg.appendChild(bg);
                
                // 绘制标题
                if (layout.title) {
                    const title = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    title.setAttribute('x', width / 2);
                    title.setAttribute('y', 30);
                    title.setAttribute('text-anchor', 'middle');
                    title.setAttribute('font-family', layout.font?.family || 'Arial');
                    title.setAttribute('font-size', '16');
                    title.setAttribute('font-weight', 'bold');
                    title.textContent = layout.title;
                    svg.appendChild(title);
                }
                
                // 计算绘图区域
                const plotWidth = width - margin.l - margin.r;
                const plotHeight = height - margin.t - margin.b;
                
                // 绘制坐标轴
                this._drawAxes(svg, margin, plotWidth, plotHeight, data, layout);
                
                // 绘制数据
                data.forEach((trace, index) => {
                    this._drawTrace(svg, trace, margin, plotWidth, plotHeight, data, layout);
                });
                
                // 绘制图例
                this._drawLegend(svg, data, width, height, margin);
            },
            
            _drawAxes: function(svg, margin, plotWidth, plotHeight, data, layout) {
                // X轴
                const xAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                xAxis.setAttribute('x1', margin.l);
                xAxis.setAttribute('y1', margin.t + plotHeight);
                xAxis.setAttribute('x2', margin.l + plotWidth);
                xAxis.setAttribute('y2', margin.t + plotHeight);
                xAxis.setAttribute('stroke', '#333');
                xAxis.setAttribute('stroke-width', '1');
                svg.appendChild(xAxis);
                
                // Y轴
                const yAxis = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                yAxis.setAttribute('x1', margin.l);
                yAxis.setAttribute('y1', margin.t);
                yAxis.setAttribute('x2', margin.l);
                yAxis.setAttribute('y2', margin.t + plotHeight);
                yAxis.setAttribute('stroke', '#333');
                yAxis.setAttribute('stroke-width', '1');
                svg.appendChild(yAxis);
                
                // 轴标签
                if (layout.xaxis?.title) {
                    const xLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    xLabel.setAttribute('x', margin.l + plotWidth / 2);
                    xLabel.setAttribute('y', margin.t + plotHeight + 40);
                    xLabel.setAttribute('text-anchor', 'middle');
                    xLabel.setAttribute('font-size', '12');
                    xLabel.textContent = layout.xaxis.title;
                    svg.appendChild(xLabel);
                }
                
                if (layout.yaxis?.title) {
                    const yLabel = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    yLabel.setAttribute('x', 20);
                    yLabel.setAttribute('y', margin.t + plotHeight / 2);
                    yLabel.setAttribute('text-anchor', 'middle');
                    yLabel.setAttribute('font-size', '12');
                    yLabel.setAttribute('transform', `rotate(-90, 20, ${margin.t + plotHeight / 2})`);
                    yLabel.textContent = layout.yaxis.title;
                    svg.appendChild(yLabel);
                }
            },
            
            _drawTrace: function(svg, trace, margin, plotWidth, plotHeight, allData, layout) {
                if (!trace.x || !trace.y) return;
                
                // 计算数据范围
                const xMin = Math.min(...trace.x);
                const xMax = Math.max(...trace.x);
                const yMin = 0;
                const yMax = Math.max(...allData.flatMap(t => t.y || []));
                
                // 创建路径
                let pathData = '';
                trace.x.forEach((x, i) => {
                    const y = trace.y[i];
                    const px = margin.l + (x - xMin) / (xMax - xMin) * plotWidth;
                    const py = margin.t + plotHeight - (y - yMin) / (yMax - yMin) * plotHeight;
                    
                    if (i === 0) {
                        pathData += `M ${px} ${py}`;
                    } else {
                        pathData += ` L ${px} ${py}`;
                    }
                    
                    // 绘制点
                    if (trace.mode?.includes('markers')) {
                        const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                        circle.setAttribute('cx', px);
                        circle.setAttribute('cy', py);
                        circle.setAttribute('r', trace.marker?.size || 3);
                        circle.setAttribute('fill', trace.marker?.color || trace.line?.color || '#1f77b4');
                        svg.appendChild(circle);
                    }
                });
                
                // 绘制线条
                if (trace.mode?.includes('lines')) {
                    const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                    path.setAttribute('d', pathData);
                    path.setAttribute('stroke', trace.line?.color || '#1f77b4');
                    path.setAttribute('stroke-width', trace.line?.width || 2);
                    path.setAttribute('fill', 'none');
                    svg.appendChild(path);
                }
            },
            
            _drawLegend: function(svg, data, width, height, margin) {
                const legendX = width - 150;
                let legendY = margin.t + 20;
                
                data.forEach((trace, index) => {
                    if (trace.name) {
                        // 图例颜色块
                        const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                        rect.setAttribute('x', legendX);
                        rect.setAttribute('y', legendY - 8);
                        rect.setAttribute('width', 15);
                        rect.setAttribute('height', 3);
                        rect.setAttribute('fill', trace.line?.color || trace.marker?.color || '#1f77b4');
                        svg.appendChild(rect);
                        
                        // 图例文字
                        const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                        text.setAttribute('x', legendX + 20);
                        text.setAttribute('y', legendY);
                        text.setAttribute('font-size', '12');
                        text.textContent = trace.name;
                        svg.appendChild(text);
                        
                        legendY += 20;
                    }
                });
            }
        };
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'PingFang SC', sans-serif;
            font-size: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            display: flex;
        }

        .sidebar {
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
        }

        .sidebar-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }

        .nav-item {
            padding: 12px 15px;
            margin: 5px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #555;
            font-weight: 500;
        }

        .nav-item:hover {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            transform: translateX(5px);
        }

        .page-content {
            margin-left: 250px;
            flex: 1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .definition-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }

        .definition-section h2 {
            color: #2d3748;
            margin-bottom: 20px;
            font-size: 1.5em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .definition-content p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #4a5568;
        }

        .formula-container {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 8px;
        }

        .formula-container h4 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .formula {
            background: white;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Times New Roman', serif;
            font-size: 1.1em;
            text-align: left;
            border: 2px solid #e2e8f0;
            margin: 10px 0;
            color: #2d3748;
        }

        .statistics-blocks {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin: 15px 0;
        }

        .stat-block {
            flex: 1;
            min-width: 200px;
            padding: 12px 16px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            text-align: left;
        }

        .stat-block:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .stat-block.expectation {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border: 2px solid #ef4444;
            color: #991b1b;
        }

        .stat-block.variance {
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
            border: 2px solid #22c55e;
            color: #166534;
        }

        .stat-block.std-deviation {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border: 2px solid #3b82f6;
            color: #1e40af;
        }

        .stat-label {
            font-size: 1.0em;
            font-weight: bold;
            margin: 0;
        }

        .stat-formula {
            font-family: 'Times New Roman', serif;
            font-size: 1.1em;
            text-align: left;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px;
            border-radius: 6px;
            backdrop-filter: blur(10px);
        }

        .formula-list {
            list-style: none;
            padding: 0;
        }

        .formula-list li {
            background: white;
            padding: 8px 15px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #667eea;
            font-family: 'Times New Roman', serif;
        }

        .parameters-info {
            background: #edf2f7;
            padding: 15px 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .parameters-info h4 {
            color: #2d3748;
            margin-bottom: 10px;
        }

        .parameters-info ul {
            list-style: none;
            padding: 0;
        }

        .parameters-info li {
            padding: 5px 0;
            color: #4a5568;
        }

        .main-panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            margin-bottom: 20px;
        }

        .controls-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .control-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .control-group h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .slider-container {
            margin-bottom: 20px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .slider-value {
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
        }

        .preset-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .preset-buttons button {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .preset-buttons button:hover,
        .preset-buttons button.active {
            background: #667eea;
            color: white;
        }

        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chart-container h3 {
            color: #495057;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.1em;
        }

        .chart-placeholder {
            height: 400px;
            width: 100%;
            display: block;
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 10px;
        }

        .stats-section {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.4em;
            font-weight: bold;
        }

        .comparison-tables {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }

        .table-container {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .table-container h3 {
            color: #495057;
            margin-bottom: 15px;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9em;
        }

        th, td {
            padding: 8px 12px;
            text-align: center;
            border-bottom: 1px solid #e9ecef;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .offline-notice {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #856404;
        }

        @media (max-width: 768px) {
            .controls-section,
            .charts-section,
            .comparison-tables {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <h3 class="sidebar-title">概率论与数理统计</h3>
        <div class="nav-item" onclick="window.location.href='../index.html'">模块概览</div>
        <div class="nav-item" onclick="window.location.href='二项分布现代化可视化_离线版.html'">二项分布</div>
        <div class="nav-item" onclick="window.location.href='泊松分布交互式可视化_完整离线版.html'">泊松分布</div>
        <div class="nav-item" onclick="window.location.href='指数分布交互式可视化.html'">指数分布</div>
        <div class="nav-item" onclick="window.location.href='正态分布交互式可视化.html'">正态分布</div>
        <div class="nav-item" onclick="window.location.href='../index.html'">返回 “概率与统计可视化世界”首页</div>
<div class="nav-item" onclick="window.location.href='../../../index.html'">返回 “万物可视化”首页</div>
    </div>
    
    <div class="page-content">
        <div class="container">
        <div class="header">
            <h1>📊 二项分布交互式可视化</h1>
            <p>交互式参数分析与统计对比 - 离线版</p>
        </div>

        <!-- 分布说明 -->
        <div class="distribution-description" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin: 20px 0; text-align: center; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);">
            <h2 style="margin: 0; font-size: 1.5em;">📊 二项分布 - 描述固定次数独立试验中成功次数的离散概率分布</h2>
        </div>

        <div class="definition-section">
            <h2>📐 数学定义</h2>
            <div class="definition-content">
                <p>二项分布是描述在固定次数的独立重复试验中成功次数的离散概率分布。每次试验只有两种可能的结果：成功或失败，且成功的概率在每次试验中保持不变。</p>
                
                <div style="background: #e8f4fd; padding: 12px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #2196F3;">
                    <h4 style="color: #1976D2; margin-bottom: 8px;">🎯 适用场景</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; color: #424242;">
                        <div>
                            <strong>工业应用：</strong><br>
                            • 质量检验：检查n个产品中有k个不合格品的概率<br>
                            • 可靠性分析：设备故障次数统计
                        </div>
                        <div>
                            <strong>生活应用：</strong><br>
                            • 医学试验：n个患者中有k个治愈的概率<br>
                            • 市场调研：n个受访者中有k个支持某观点的概率<br>
                            • 投篮命中：投篮n次命中k次的概率
                        </div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div class="formula-container">
                        <h4>概率质量函数 (PMF)：</h4>
                        <div class="formula">
                            $$P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}$$，其中 $\binom{n}{k} = \frac{n!}{k!(n-k)!}$
                        </div>
                    </div>

                    <div class="formula-container">
                        <h4>累积分布函数 (CDF)：</h4>
                        <div class="formula">
                            $$F(k) = P(X \leq k) = \sum_{i=0}^{k} \binom{n}{i} p^i (1-p)^{n-i}$$
                        </div>
                    </div>
                </div>

                <div class="formula-container">
                    <h4>参数：</h4>
                    <div class="parameters-info" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 10px 0;">
                        <ul style="margin: 0; padding-left: 20px; list-style-type: none;">
                            <li style="margin: 8px 0;"><strong>$n$：</strong>试验次数（正整数）- 表示独立重复试验的总次数</li>
                            <li style="margin: 8px 0;"><strong>$p$：</strong>成功概率（$0 < p < 1$）- 表示单次试验成功的概率</li>
                            <li style="margin: 8px 0;"><strong>$k$：</strong>成功次数（$0 \leq k \leq n$）- 表示$n$次试验中成功的次数</li>
                        </ul>
                    </div>
                </div>

                <div class="formula-container">
                    <h4>统计特性：</h4>
                    <div class="statistics-blocks">
                        <div class="stat-block expectation">
                            <div class="stat-label"><strong>期望值：</strong></div>
                            <div class="stat-formula">$$E(X) = np$$</div>
                        </div>
                        <div class="stat-block variance">
                            <div class="stat-label"><strong>方差：</strong></div>
                            <div class="stat-formula">$$\text{Var}(X) = np(1-p)$$</div>
                        </div>
                        <div class="stat-block std-deviation">
                            <div class="stat-label"><strong>标准差：</strong></div>
                            <div class="stat-formula">$$\sigma = \sqrt{np(1-p)}$$</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="offline-notice">
            <strong>离线版本说明：</strong> 本版本使用内嵌的简化绘图引擎，无需网络连接即可使用。
            如需完整功能，请下载 <a href="https://cdn.plot.ly/plotly-2.26.0.min.js" target="_blank">plotly.min.js</a> 并替换内嵌代码。
        </div>

        <div class="main-panel">
            <!-- 参数控制区域 -->
            <div class="controls-section">
                <div class="control-group">
                    <h3>🎯 试验次数 (n)</h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>试验次数</span>
                            <span class="slider-value" id="nValue">20</span>
                        </div>
                        <input type="range" id="nSlider" class="slider" min="5" max="100" value="20" step="1">
                        <div class="preset-buttons">
                            <button onclick="setN(10)">n=10</button>
                            <button onclick="setN(20)" class="active">n=20</button>
                            <button onclick="setN(50)">n=50</button>
                            <button onclick="setN(100)">n=100</button>
                        </div>
                    </div>
                </div>

                <div class="control-group">
                    <h3>🎲 成功概率 (p)</h3>
                    <div class="slider-container">
                        <div class="slider-label">
                            <span>成功概率</span>
                            <span class="slider-value" id="pValue">0.5</span>
                        </div>
                        <input type="range" id="pSlider" class="slider" min="0.01" max="0.99" value="0.5" step="0.01">
                        <div class="preset-buttons">
                            <button onclick="setP(0.1)">p=0.1</button>
                            <button onclick="setP(0.3)">p=0.3</button>
                            <button onclick="setP(0.5)" class="active">p=0.5</button>
                            <button onclick="setP(0.7)">p=0.7</button>
                            <button onclick="setP(0.9)">p=0.9</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 统计信息 -->
            <div class="stats-section">
                <h3>📈 当前分布统计信息</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">期望值 E(X)</div>
                        <div class="stat-value" id="meanValue">10.0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">方差 Var(X)</div>
                        <div class="stat-value" id="varianceValue">5.0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">标准差 σ</div>
                        <div class="stat-value" id="stdValue">2.24</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">变异系数 CV</div>
                        <div class="stat-value" id="cvValue">0.224</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">众数 Mode</div>
                        <div class="stat-value" id="modeValue">10</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">偏度 Skewness</div>
                        <div class="stat-value" id="skewnessValue">0.000</div>
                    </div>
                </div>
            </div>

            <!-- 参数对比图表 -->
            <div class="charts-section">
                <div class="chart-container">
                    <h3>🔄 固定 n，变化 p 的分布对比</h3>
                    <div id="fixedNChart" class="chart-placeholder"></div>
                </div>
                <div class="chart-container">
                    <h3>🔄 固定 p，变化 n 的分布对比</h3>
                    <div id="fixedPChart" class="chart-placeholder"></div>
                </div>
            </div>

            <!-- 对比表格 -->
            <div class="comparison-tables">
                <div class="table-container">
                    <h3>📊 不同 p 值统计对比 (n = <span id="currentN">20</span>)</h3>
                    <table id="pComparisonTable">
                        <thead>
                            <tr>
                                <th>p</th>
                                <th>期望</th>
                                <th>方差</th>
                                <th>标准差</th>
                                <th>变异系数</th>
                                <th>众数</th>
                                <th>偏度</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>

                <div class="table-container">
                    <h3>📊 不同 n 值统计对比 (p = <span id="currentP">0.5</span>)</h3>
                    <table id="nComparisonTable">
                        <thead>
                            <tr>
                                <th>n</th>
                                <th>期望</th>
                                <th>方差</th>
                                <th>标准差</th>
                                <th>变异系数</th>
                                <th>众数</th>
                                <th>偏度</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let currentN = 20;
        let currentP = 0.5;

        // 二项分布概率质量函数
        function binomialPMF(n, p, k) {
            function combination(n, k) {
                if (k > n) return 0;
                if (k === 0 || k === n) return 1;
                
                let result = 1;
                for (let i = 0; i < Math.min(k, n - k); i++) {
                    result = result * (n - i) / (i + 1);
                }
                return result;
            }
            
            return combination(n, k) * Math.pow(p, k) * Math.pow(1 - p, n - k);
        }

        // 计算统计量
        function calculateStats(n, p) {
            const mean = n * p;
            const variance = n * p * (1 - p);
            const std = Math.sqrt(variance);
            const cv = std / mean;
            const mode = Math.floor((n + 1) * p);
            const skewness = (1 - 2 * p) / std;
            
            return { mean, variance, std, cv, mode, skewness };
        }

        // 更新统计信息显示
        function updateStats() {
            const stats = calculateStats(currentN, currentP);
            
            document.getElementById('meanValue').textContent = stats.mean.toFixed(2);
            document.getElementById('varianceValue').textContent = stats.variance.toFixed(2);
            document.getElementById('stdValue').textContent = stats.std.toFixed(2);
            document.getElementById('cvValue').textContent = stats.cv.toFixed(3);
            document.getElementById('modeValue').textContent = stats.mode;
            document.getElementById('skewnessValue').textContent = stats.skewness.toFixed(3);
        }

        // 绘制固定n变化p的对比图
        function plotFixedN() {
            const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe'];
            const pValues = [0.1, 0.3, 0.5, 0.7, 0.9];
            const traces = [];

            pValues.forEach((p, index) => {
                const x = [];
                const y = [];
                
                for (let k = 0; k <= currentN; k++) {
                    x.push(k);
                    y.push(binomialPMF(currentN, p, k));
                }

                traces.push({
                    x: x,
                    y: y,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: `p = ${p}`,
                    line: {
                        color: colors[index],
                        width: 2
                    },
                    marker: {
                        color: colors[index],
                        size: 4
                    }
                });
            });

            const layout = {
                title: `固定 n = ${currentN}，不同 p 值的分布对比`,
                xaxis: { 
                    title: '成功次数 k',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                yaxis: { 
                    title: '概率 P(X = k)',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                plot_bgcolor: 'rgba(0,0,0,0)',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { family: 'Microsoft YaHei, sans-serif' },
                margin: { t: 50, r: 20, b: 60, l: 60 },
                legend: {
                    x: 1,
                    y: 1,
                    bgcolor: 'rgba(255,255,255,0.8)'
                }
            };

            const container = document.getElementById('fixedNChart');
            if (container && typeof Plotly !== 'undefined') {
                Plotly.newPlot('fixedNChart', traces, layout, {responsive: true});
            }
        }

        // 绘制固定p变化n的对比图
        function plotFixedP() {
            const colors = ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe'];
            const nValues = [10, 20, 50, 80, 100];
            const traces = [];

            nValues.forEach((n, index) => {
                const x = [];
                const y = [];
                
                for (let k = 0; k <= n; k++) {
                    x.push(k);
                    y.push(binomialPMF(n, currentP, k));
                }

                traces.push({
                    x: x,
                    y: y,
                    type: 'scatter',
                    mode: 'lines+markers',
                    name: `n = ${n}`,
                    line: {
                        color: colors[index],
                        width: 2
                    },
                    marker: {
                        color: colors[index],
                        size: 4
                    }
                });
            });

            const layout = {
                title: `固定 p = ${currentP}，不同 n 值的分布对比`,
                xaxis: { 
                    title: '成功次数 k',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                yaxis: { 
                    title: '概率 P(X = k)',
                    showgrid: true,
                    gridcolor: 'rgba(0,0,0,0.1)'
                },
                plot_bgcolor: 'rgba(0,0,0,0)',
                paper_bgcolor: 'rgba(0,0,0,0)',
                font: { family: 'Microsoft YaHei, sans-serif' },
                margin: { t: 50, r: 20, b: 60, l: 60 },
                legend: {
                    x: 1,
                    y: 1,
                    bgcolor: 'rgba(255,255,255,0.8)'
                }
            };

            const container = document.getElementById('fixedPChart');
            if (container && typeof Plotly !== 'undefined') {
                Plotly.newPlot('fixedPChart', traces, layout, {responsive: true});
            }
        }

        // 更新对比表格
        function updateComparisonTable() {
            const pValues = [0.1, 0.3, 0.5, 0.7, 0.9];
            const tbody = document.querySelector('#pComparisonTable tbody');
            tbody.innerHTML = '';

            pValues.forEach(p => {
                const stats = calculateStats(currentN, p);
                const row = tbody.insertRow();
                
                row.insertCell(0).textContent = p.toFixed(1);
                row.insertCell(1).textContent = stats.mean.toFixed(2);
                row.insertCell(2).textContent = stats.variance.toFixed(2);
                row.insertCell(3).textContent = stats.std.toFixed(2);
                row.insertCell(4).textContent = stats.cv.toFixed(3);
                row.insertCell(5).textContent = stats.mode;
                row.insertCell(6).textContent = stats.skewness.toFixed(3);
                
                // 高亮当前p值
                if (Math.abs(p - currentP) < 0.05) {
                    row.style.backgroundColor = '#e6fffa';
                    row.style.fontWeight = 'bold';
                }
            });
        }

        function updateNComparisonTable() {
            const nValues = [10, 20, 50, 80, 100];
            const tbody = document.querySelector('#nComparisonTable tbody');
            tbody.innerHTML = '';

            nValues.forEach(n => {
                const stats = calculateStats(n, currentP);
                const row = tbody.insertRow();
                
                row.insertCell(0).textContent = n;
                row.insertCell(1).textContent = stats.mean.toFixed(2);
                row.insertCell(2).textContent = stats.variance.toFixed(2);
                row.insertCell(3).textContent = stats.std.toFixed(2);
                row.insertCell(4).textContent = stats.cv.toFixed(3);
                row.insertCell(5).textContent = stats.mode;
                row.insertCell(6).textContent = stats.skewness.toFixed(3);
                
                // 高亮当前n值
                if (n === currentN) {
                    row.style.backgroundColor = '#e6fffa';
                    row.style.fontWeight = 'bold';
                }
            });
        }

        // 更新所有图表和统计
        function updateAll() {
            updateStats();
            plotFixedN();
            plotFixedP();
            updateComparisonTable();
            updateNComparisonTable();
            
            // 更新表格标题中的当前值
            document.getElementById('currentN').textContent = currentN;
            document.getElementById('currentP').textContent = currentP;
        }

        // 设置n值
        function setN(n) {
            currentN = n;
            document.getElementById('nSlider').value = n;
            document.getElementById('nValue').textContent = n;
            
            // 更新按钮状态
            document.querySelectorAll('.preset-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateAll();
        }

        // 设置p值
        function setP(p) {
            currentP = p;
            document.getElementById('pSlider').value = p;
            document.getElementById('pValue').textContent = p;
            
            // 更新按钮状态
            document.querySelectorAll('.preset-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateAll();
        }

        // 滑动条事件监听
        document.getElementById('nSlider').addEventListener('input', function() {
            currentN = parseInt(this.value);
            document.getElementById('nValue').textContent = currentN;
            updateAll();
        });

        document.getElementById('pSlider').addEventListener('input', function() {
            currentP = parseFloat(this.value);
            document.getElementById('pValue').textContent = currentP;
            updateAll();
        });

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            updateAll();
        });
    </script>
    </div>
</body>
</html>